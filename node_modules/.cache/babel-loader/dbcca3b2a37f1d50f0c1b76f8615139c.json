{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/narendraomprakash/Desktop/Narendra/Semester-V-FALL2021/PDC/J-Component/Integrated-CryptRidez/src/App.js\";\nimport './App.scss';\nimport { Switch, Route, BrowserRouter as Router } from 'react-router-dom';\nimport React, { Component } from 'react';\nimport Web3 from 'web3';\nimport user from './abis/user.json';\nimport { AuthProvider } from './contexts/AuthContext';\nimport NavBar from './Components/NavBar';\nimport PrivateRoute from './Components/PrivateRoute';\nimport Dashboard from './Pages/Dashboard'; // IPFS for ID proofs of Driver\n\nconst ipfsClient = require('ipfs-http-client');\n\nconst ipfs = ipfsClient({\n  host: 'ipfs.infura.io',\n  port: 5001,\n  protocol: 'https'\n}); // leaving out the arguments will default to these values\n\nconst authorizedAccounts = ['0x50Fe6C433c41595396044A9bcdF9500963D4e236'];\nconst authorizedAccounts2 = ['0x2fb5eBC35A6d6e7c26bEC01122b34d84D7727aD9'];\n\nclass App extends Component {\n  async componentWillMount() {\n    await this.loadWeb3();\n    await this.loadBlockchainData();\n  }\n\n  async loadWeb3() {\n    if (window.ethereum) {\n      window.web3 = new Web3(window.ethereum);\n      await window.ethereum.enable();\n    } else if (window.web3) {\n      window.web3 = new Web3(window.web3.currentProvider);\n    } else {\n      window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');\n    }\n  }\n\n  async loadBlockchainData() {\n    const web3 = window.web3; // Load account\n\n    const accounts = await web3.eth.getAccounts();\n    this.setState({\n      account: accounts[0]\n    });\n    const unitbal = await web3.eth.getBalance(accounts[0]);\n    const balanceacc = await web3.utils.fromWei(unitbal, 'ether');\n    this.setState({\n      balance: balanceacc\n    });\n    const networkId = await web3.eth.net.getId();\n    const networkData = user.networks[networkId];\n    console.log(networkData);\n\n    if (networkData) {\n      const User = new web3.eth.Contract(user.abi, networkData.address);\n      this.setState({\n        User\n      });\n      const reqCounts = await User.methods.reqCount().call();\n      this.setState({\n        reqCounts\n      });\n      const imgCounts = await User.methods.imgCount().call();\n      this.setState({\n        imgCounts\n      });\n      const rideCounts = await User.methods.rideCount().call();\n      this.setState({\n        rideCounts\n      }); //Load requests\n\n      for (var i = 1; i <= reqCounts; i++) {\n        const users_var = await User.methods.users(i).call();\n        this.setState({\n          users: [...this.state.users, users_var]\n        });\n      } //Load images\n\n\n      for (var j = 1; j <= imgCounts; j++) {\n        const img_var = await User.methods.driver(j).call();\n        this.setState({\n          driver: [...this.state.driver, img_var]\n        });\n      }\n      /** */\n\n\n      for (var k = 1; k <= rideCounts; k++) {\n        const ride_var = await User.methods.ride(k).call();\n        this.setState({\n          ride: [...this.state.ride, ride_var]\n        });\n      }\n    } else {\n      window.alert('User contract not deployed to detected network.');\n    }\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.uploadIdProof = event => {\n      event.preventDefault();\n      const file = event.target.files[0];\n      const reader = new window.FileReader();\n      reader.readAsArrayBuffer(file);\n\n      reader.onloadend = () => {\n        this.setState({\n          buffer: Buffer(reader.result)\n        });\n        console.log('buffer', this.state.buffer);\n      };\n    };\n\n    this.rideRequest = (source, destination, date, time) => {\n      this.setState({\n        loading: true\n      });\n      this.state.User.methods.rideReq(source, destination, date, time).send({\n        from: this.state.account\n      }).on('transactionHash', hash => {\n        this.setState({\n          loading: false\n        });\n      });\n    };\n\n    this.uploadRide = (source, destination, date, time, rider, amount) => {\n      this.setState({\n        loading: true\n      });\n      this.state.User.methods.uploadRide(source, destination, date, time, rider, amount).send({\n        from: this.state.account\n      }).on('transactionHash', hash => {\n        this.setState({\n          loading: false\n        });\n      });\n    };\n\n    this.uploadIdImage = (drivername, hash, verified) => {\n      this.state.User.methods.uploadImg(hash, drivername, verified).send({\n        from: this.state.account\n      }).on('transactionHash', hash => {\n        this.setState({\n          loading: false\n        });\n      });\n    };\n\n    this.uploadImage = drivername => {\n      // console.log(\"submitting file to ipfs...\")\n      ipfs.add(this.state.buffer, (error, result) => {\n        // console.log('Ipfs result', result)\n        if (error) {\n          console.error(error);\n          return;\n        }\n\n        this.setState({\n          loading: true\n        });\n        this.state.User.methods.uploadImg(result[0].hash, drivername, false).send({\n          from: this.state.account\n        }).on('transactionHash', hash => {\n          this.setState({\n            loading: false\n          });\n        });\n      });\n    };\n\n    this.verifyDriver = (id, hashs, name, author) => {\n      this.state.User.methods.verifyDriver(id, hashs, name, author).send({\n        from: this.state.account\n      }).on('transactionHash', hash => {\n        this.setState({\n          loading: false\n        });\n      });\n    };\n\n    this.tipImageOwner = (id, tipAmount) => {\n      this.setState({\n        loading: true\n      });\n      this.setState({\n        loading: false\n      });\n      this.state.cryptridez.methods.tipImageOwner(id).send({\n        from: this.state.account,\n        value: tipAmount\n      }).on('transactionHash', hash => {});\n    };\n\n    this.rideAmount = (id, amount) => {\n      this.state.User.methods.ridePayment(id).send({\n        from: this.state.account,\n        value: amount\n      }).on('transactionHash', hash => {});\n    };\n\n    this.state = {\n      balance: '',\n      account: '',\n      User: null,\n      users: [],\n      driver: [],\n      ride: [],\n      loading: true,\n      navToggle: false\n    };\n  }\n\n  render() {\n    //  let body;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"main-content\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"content\",\n          children: /*#__PURE__*/_jsxDEV(Router, {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: `sidebar ${this.state.navToggle ? 'nav-toggle' : ''}`,\n              children: /*#__PURE__*/_jsxDEV(NavBar, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 202,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"nav-btn\",\n              onClick: this.setState({\n                navToggle: true\n              }),\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lines-1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 205,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lines-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lines-3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 207,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(AuthProvider, {\n              children: /*#__PURE__*/_jsxDEV(Switch, {\n                children: /*#__PURE__*/_jsxDEV(PrivateRoute, {\n                  exact: true,\n                  path: \"/\",\n                  component: Dashboard\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 11\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/narendraomprakash/Desktop/Narendra/Semester-V-FALL2021/PDC/J-Component/Integrated-CryptRidez/src/App.js"],"names":["Switch","Route","BrowserRouter","Router","React","Component","Web3","user","AuthProvider","NavBar","PrivateRoute","Dashboard","ipfsClient","require","ipfs","host","port","protocol","authorizedAccounts","authorizedAccounts2","App","componentWillMount","loadWeb3","loadBlockchainData","window","ethereum","web3","enable","currentProvider","alert","accounts","eth","getAccounts","setState","account","unitbal","getBalance","balanceacc","utils","fromWei","balance","networkId","net","getId","networkData","networks","console","log","User","Contract","abi","address","reqCounts","methods","reqCount","call","imgCounts","imgCount","rideCounts","rideCount","i","users_var","users","state","j","img_var","driver","k","ride_var","ride","constructor","props","uploadIdProof","event","preventDefault","file","target","files","reader","FileReader","readAsArrayBuffer","onloadend","buffer","Buffer","result","rideRequest","source","destination","date","time","loading","rideReq","send","from","on","hash","uploadRide","rider","amount","uploadIdImage","drivername","verified","uploadImg","uploadImage","add","error","verifyDriver","id","hashs","name","author","tipImageOwner","tipAmount","cryptridez","value","rideAmount","ridePayment","navToggle","render"],"mappings":";;AAAA,OAAO,YAAP;AAEA,SAAQA,MAAR,EAAeC,KAAf,EAAsBC,aAAa,IAAIC,MAAvC,QAAoD,kBAApD;AAEA,OAAOC,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,IAAP,MAAiB,MAAjB;AAEA,OAAOC,IAAP,MAAiB,kBAAjB;AAEA,SAASC,YAAT,QAA6B,wBAA7B;AAEA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,OAAOC,YAAP,MAAyB,2BAAzB;AAGA,OAAOC,SAAP,MAAsB,mBAAtB,C,CAIA;;AACA,MAAMC,UAAU,GAAGC,OAAO,CAAC,kBAAD,CAA1B;;AACA,MAAMC,IAAI,GAAGF,UAAU,CAAC;AAAEG,EAAAA,IAAI,EAAE,gBAAR;AAA0BC,EAAAA,IAAI,EAAE,IAAhC;AAAsCC,EAAAA,QAAQ,EAAE;AAAhD,CAAD,CAAvB,C,CAAoF;;AAEpF,MAAMC,kBAAkB,GAAG,CAAC,4CAAD,CAA3B;AACA,MAAMC,mBAAmB,GAAG,CAAC,4CAAD,CAA5B;;AAEA,MAAMC,GAAN,SAAkBf,SAAlB,CAA2B;AACzB,QAAMgB,kBAAN,GAA2B;AACzB,UAAM,KAAKC,QAAL,EAAN;AACA,UAAM,KAAKC,kBAAL,EAAN;AACD;;AAED,QAAMD,QAAN,GAAiB;AACf,QAAIE,MAAM,CAACC,QAAX,EAAqB;AACnBD,MAAAA,MAAM,CAACE,IAAP,GAAc,IAAIpB,IAAJ,CAASkB,MAAM,CAACC,QAAhB,CAAd;AACA,YAAMD,MAAM,CAACC,QAAP,CAAgBE,MAAhB,EAAN;AACD,KAHD,MAIK,IAAIH,MAAM,CAACE,IAAX,EAAiB;AACpBF,MAAAA,MAAM,CAACE,IAAP,GAAc,IAAIpB,IAAJ,CAASkB,MAAM,CAACE,IAAP,CAAYE,eAArB,CAAd;AACD,KAFI,MAGA;AACHJ,MAAAA,MAAM,CAACK,KAAP,CAAa,qEAAb;AACD;AACF;;AAED,QAAMN,kBAAN,GAA2B;AACzB,UAAMG,IAAI,GAAGF,MAAM,CAACE,IAApB,CADyB,CAEzB;;AACA,UAAMI,QAAQ,GAAG,MAAMJ,IAAI,CAACK,GAAL,CAASC,WAAT,EAAvB;AAGA,SAAKC,QAAL,CAAc;AAAEC,MAAAA,OAAO,EAAEJ,QAAQ,CAAC,CAAD;AAAnB,KAAd;AACA,UAAMK,OAAO,GAAG,MAAMT,IAAI,CAACK,GAAL,CAASK,UAAT,CAAoBN,QAAQ,CAAC,CAAD,CAA5B,CAAtB;AACA,UAAOO,UAAU,GAAG,MAAMX,IAAI,CAACY,KAAL,CAAWC,OAAX,CAAmBJ,OAAnB,EAA2B,OAA3B,CAA1B;AAEA,SAAKF,QAAL,CAAc;AAACO,MAAAA,OAAO,EAAEH;AAAV,KAAd;AAEA,UAAMI,SAAS,GAAG,MAAMf,IAAI,CAACK,GAAL,CAASW,GAAT,CAAaC,KAAb,EAAxB;AACA,UAAMC,WAAW,GAAGrC,IAAI,CAACsC,QAAL,CAAcJ,SAAd,CAApB;AACAK,IAAAA,OAAO,CAACC,GAAR,CAAYH,WAAZ;;AAEA,QAAIA,WAAJ,EAAiB;AACf,YAAMI,IAAI,GAAG,IAAItB,IAAI,CAACK,GAAL,CAASkB,QAAb,CAAsB1C,IAAI,CAAC2C,GAA3B,EAAgCN,WAAW,CAACO,OAA5C,CAAb;AACA,WAAKlB,QAAL,CAAc;AAAEe,QAAAA;AAAF,OAAd;AAEA,YAAMI,SAAS,GAAG,MAAMJ,IAAI,CAACK,OAAL,CAAaC,QAAb,GAAwBC,IAAxB,EAAxB;AACA,WAAKtB,QAAL,CAAc;AAAEmB,QAAAA;AAAF,OAAd;AAEA,YAAMI,SAAS,GAAG,MAAMR,IAAI,CAACK,OAAL,CAAaI,QAAb,GAAwBF,IAAxB,EAAxB;AACA,WAAKtB,QAAL,CAAc;AAAEuB,QAAAA;AAAF,OAAd;AAEA,YAAME,UAAU,GAAG,MAAMV,IAAI,CAACK,OAAL,CAAaM,SAAb,GAAyBJ,IAAzB,EAAzB;AACA,WAAKtB,QAAL,CAAc;AAAEyB,QAAAA;AAAF,OAAd,EAXe,CAaf;;AACA,WAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIR,SAArB,EAAgCQ,CAAC,EAAjC,EAAqC;AACnC,cAAMC,SAAS,GAAG,MAAMb,IAAI,CAACK,OAAL,CAAaS,KAAb,CAAmBF,CAAnB,EAAsBL,IAAtB,EAAxB;AACA,aAAKtB,QAAL,CAAc;AACZ6B,UAAAA,KAAK,EAAE,CAAC,GAAG,KAAKC,KAAL,CAAWD,KAAf,EAAqBD,SAArB;AADK,SAAd;AAGD,OAnBc,CAqBf;;;AAEA,WAAK,IAAIG,CAAC,GAAC,CAAX,EAAcA,CAAC,IAAER,SAAjB,EAA4BQ,CAAC,EAA7B,EAAgC;AAC9B,cAAMC,OAAO,GAAG,MAAMjB,IAAI,CAACK,OAAL,CAAaa,MAAb,CAAoBF,CAApB,EAAuBT,IAAvB,EAAtB;AACA,aAAKtB,QAAL,CAAc;AACZiC,UAAAA,MAAM,EAAE,CAAC,GAAG,KAAKH,KAAL,CAAWG,MAAf,EAAsBD,OAAtB;AADI,SAAd;AAGD;AACF;;;AAEA,WAAK,IAAIE,CAAC,GAAC,CAAX,EAAcA,CAAC,IAAET,UAAjB,EAA6BS,CAAC,EAA9B,EAAiC;AAChC,cAAMC,QAAQ,GAAG,MAAMpB,IAAI,CAACK,OAAL,CAAagB,IAAb,CAAkBF,CAAlB,EAAqBZ,IAArB,EAAvB;AACA,aAAKtB,QAAL,CAAc;AACZoC,UAAAA,IAAI,EAAE,CAAC,GAAG,KAAKN,KAAL,CAAWM,IAAf,EAAoBD,QAApB;AADM,SAAd;AAGD;AAEA,KAtCD,MAsCO;AACL5C,MAAAA,MAAM,CAACK,KAAP,CAAa,iDAAb;AACD;AAGF;;AAwECyC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAtErBC,aAsEqB,GAtENC,KAAK,IAAI;AACtBA,MAAAA,KAAK,CAACC,cAAN;AACA,YAAMC,IAAI,GAAGF,KAAK,CAACG,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAAb;AACA,YAAMC,MAAM,GAAG,IAAItD,MAAM,CAACuD,UAAX,EAAf;AACAD,MAAAA,MAAM,CAACE,iBAAP,CAAyBL,IAAzB;;AAEAG,MAAAA,MAAM,CAACG,SAAP,GAAmB,MAAM;AACvB,aAAKhD,QAAL,CAAc;AAAEiD,UAAAA,MAAM,EAAEC,MAAM,CAACL,MAAM,CAACM,MAAR;AAAhB,SAAd;AACAtC,QAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsB,KAAKgB,KAAL,CAAWmB,MAAjC;AACD,OAHD;AAID,KA4DoB;;AAAA,SA1DrBG,WA0DqB,GA1DP,CAACC,MAAD,EAAQC,WAAR,EAAoBC,IAApB,EAAyBC,IAAzB,KAAkC;AAC9C,WAAKxD,QAAL,CAAc;AAACyD,QAAAA,OAAO,EAAC;AAAT,OAAd;AACE,WAAK3B,KAAL,CAAWf,IAAX,CAAgBK,OAAhB,CAAwBsC,OAAxB,CAAgCL,MAAhC,EAAuCC,WAAvC,EAAmDC,IAAnD,EAAwDC,IAAxD,EAA8DG,IAA9D,CAAmE;AAACC,QAAAA,IAAI,EAAE,KAAK9B,KAAL,CAAW7B;AAAlB,OAAnE,EAA+F4D,EAA/F,CAAkG,iBAAlG,EAAsHC,IAAD,IAAU;AAC7H,aAAK9D,QAAL,CAAc;AAAEyD,UAAAA,OAAO,EAAE;AAAX,SAAd;AACD,OAFD;AAGH,KAqDoB;;AAAA,SAnDrBM,UAmDqB,GAnDR,CAACV,MAAD,EAAQC,WAAR,EAAoBC,IAApB,EAAyBC,IAAzB,EAA8BQ,KAA9B,EAAoCC,MAApC,KAA+C;AAC1D,WAAKjE,QAAL,CAAc;AAACyD,QAAAA,OAAO,EAAC;AAAT,OAAd;AACE,WAAK3B,KAAL,CAAWf,IAAX,CAAgBK,OAAhB,CAAwB2C,UAAxB,CAAmCV,MAAnC,EAA0CC,WAA1C,EAAsDC,IAAtD,EAA2DC,IAA3D,EAAgEQ,KAAhE,EAAsEC,MAAtE,EAA8EN,IAA9E,CAAmF;AAACC,QAAAA,IAAI,EAAE,KAAK9B,KAAL,CAAW7B;AAAlB,OAAnF,EAA+G4D,EAA/G,CAAkH,iBAAlH,EAAsIC,IAAD,IAAU;AAC7I,aAAK9D,QAAL,CAAc;AAAEyD,UAAAA,OAAO,EAAE;AAAX,SAAd;AACD,OAFD;AAGH,KA8CoB;;AAAA,SA5CrBS,aA4CqB,GA5CL,CAACC,UAAD,EAAYL,IAAZ,EAAiBM,QAAjB,KAChB;AACE,WAAKtC,KAAL,CAAWf,IAAX,CAAgBK,OAAhB,CAAwBiD,SAAxB,CAAkCP,IAAlC,EAAuCK,UAAvC,EAAkDC,QAAlD,EAA4DT,IAA5D,CAAiE;AAACC,QAAAA,IAAI,EAAE,KAAK9B,KAAL,CAAW7B;AAAlB,OAAjE,EAA6F4D,EAA7F,CAAgG,iBAAhG,EAAmHC,IAAD,IAAU;AAC1H,aAAK9D,QAAL,CAAc;AAACyD,UAAAA,OAAO,EAAC;AAAT,SAAd;AACD,OAFD;AAID,KAsCoB;;AAAA,SArCrBa,WAqCqB,GArCPH,UAAU,IAAI;AAC1B;AAEAtF,MAAAA,IAAI,CAAC0F,GAAL,CAAS,KAAKzC,KAAL,CAAWmB,MAApB,EAA4B,CAACuB,KAAD,EAAQrB,MAAR,KAAmB;AAC7C;AACA,YAAIqB,KAAJ,EAAW;AACT3D,UAAAA,OAAO,CAAC2D,KAAR,CAAcA,KAAd;AACA;AACD;;AAEH,aAAKxE,QAAL,CAAc;AAACyD,UAAAA,OAAO,EAAC;AAAT,SAAd;AACE,aAAK3B,KAAL,CAAWf,IAAX,CAAgBK,OAAhB,CAAwBiD,SAAxB,CAAkClB,MAAM,CAAC,CAAD,CAAN,CAAUW,IAA5C,EAAiDK,UAAjD,EAA4D,KAA5D,EAAmER,IAAnE,CAAwE;AAACC,UAAAA,IAAI,EAAE,KAAK9B,KAAL,CAAW7B;AAAlB,SAAxE,EAAoG4D,EAApG,CAAuG,iBAAvG,EAA0HC,IAAD,IAAU;AACjI,eAAK9D,QAAL,CAAc;AAACyD,YAAAA,OAAO,EAAC;AAAT,WAAd;AACD,SAFD;AAGD,OAXD;AAYD,KAsBoB;;AAAA,SArBrBgB,YAqBqB,GArBN,CAACC,EAAD,EAAIC,KAAJ,EAAUC,IAAV,EAAeC,MAAf,KAA0B;AAEvC,WAAK/C,KAAL,CAAWf,IAAX,CAAgBK,OAAhB,CAAwBqD,YAAxB,CAAqCC,EAArC,EAAwCC,KAAxC,EAA8CC,IAA9C,EAAmDC,MAAnD,EAA2DlB,IAA3D,CAAgE;AAACC,QAAAA,IAAI,EAAE,KAAK9B,KAAL,CAAW7B;AAAlB,OAAhE,EAA4F4D,EAA5F,CAA+F,iBAA/F,EAAkHC,IAAD,IAAU;AACzH,aAAK9D,QAAL,CAAc;AAACyD,UAAAA,OAAO,EAAC;AAAT,SAAd;AACD,OAFD;AAGC,KAgBkB;;AAAA,SAdnBqB,aAcmB,GAdH,CAACJ,EAAD,EAAKK,SAAL,KAAkB;AAChC,WAAK/E,QAAL,CAAc;AAAEyD,QAAAA,OAAO,EAAE;AAAX,OAAd;AACA,WAAKzD,QAAL,CAAc;AAAEyD,QAAAA,OAAO,EAAE;AAAX,OAAd;AACA,WAAK3B,KAAL,CAAWkD,UAAX,CAAsB5D,OAAtB,CAA8B0D,aAA9B,CAA4CJ,EAA5C,EAAgDf,IAAhD,CAAqD;AAAEC,QAAAA,IAAI,EAAE,KAAK9B,KAAL,CAAW7B,OAAnB;AAA4BgF,QAAAA,KAAK,EAAEF;AAAnC,OAArD,EAAqGlB,EAArG,CAAwG,iBAAxG,EAA4HC,IAAD,IAAU,CACpI,CADD;AAED,KASkB;;AAAA,SAPnBoB,UAOmB,GAPN,CAACR,EAAD,EAAIT,MAAJ,KAAc;AACzB,WAAKnC,KAAL,CAAWf,IAAX,CAAgBK,OAAhB,CAAwB+D,WAAxB,CAAoCT,EAApC,EAAwCf,IAAxC,CAA6C;AAAEC,QAAAA,IAAI,EAAE,KAAK9B,KAAL,CAAW7B,OAAnB;AAA4BgF,QAAAA,KAAK,EAAEhB;AAAnC,OAA7C,EAA0FJ,EAA1F,CAA6F,iBAA7F,EAAiHC,IAAD,IAAU,CACzH,CADD;AAID,KAEkB;;AAEjB,SAAKhC,KAAL,GAAa;AACXvB,MAAAA,OAAO,EAAC,EADG;AAEXN,MAAAA,OAAO,EAAE,EAFE;AAGXc,MAAAA,IAAI,EAAE,IAHK;AAIXc,MAAAA,KAAK,EAAC,EAJK;AAKXI,MAAAA,MAAM,EAAC,EALI;AAMXG,MAAAA,IAAI,EAAC,EANM;AAOXqB,MAAAA,OAAO,EAAE,IAPE;AAQX2B,MAAAA,SAAS,EAAC;AARC,KAAb;AAWD;;AAEFC,EAAAA,MAAM,GAAE;AACP;AAEC,wBACK;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA,6BAEE;AAAK,QAAA,SAAS,EAAC,cAAf;AAAA,+BACI;AAAK,UAAA,SAAS,EAAC,SAAf;AAAA,iCACA,QAAC,MAAD;AAAA,oCACA;AAAK,cAAA,SAAS,EAAG,WAAU,KAAKvD,KAAL,CAAWsD,SAAX,GAAuB,YAAvB,GAAqC,EAAG,EAAnE;AAAA,qCACA,QAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,oBADA,eAIJ;AAAK,cAAA,SAAS,EAAC,SAAf;AAAyB,cAAA,OAAO,EAAE,KAAKpF,QAAL,CAAc;AAACoF,gBAAAA,SAAS,EAAE;AAAZ,eAAd,CAAlC;AAAA,sCACE;AAAK,gBAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,sBADF,eAEE;AAAK,gBAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,sBAFF,eAGE;AAAK,gBAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,sBAHF;AAAA;AAAA;AAAA;AAAA;AAAA,oBAJI,eASI,QAAC,YAAD;AAAA,qCACE,QAAC,MAAD;AAAA,uCAEE,QAAC,YAAD;AAAc,kBAAA,KAAK,MAAnB;AAAoB,kBAAA,IAAI,EAAC,GAAzB;AAA6B,kBAAA,SAAS,EAAE1G;AAAxC;AAAA;AAAA;AAAA;AAAA;AAFF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBATJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AAFF;AAAA;AAAA;AAAA;AAAA,YADL;AA2BE;;AAnMoB;;AAwM3B,eAAeS,GAAf","sourcesContent":["import './App.scss';\n\nimport {Switch,Route, BrowserRouter as Router} from 'react-router-dom';\n\nimport React, { Component } from 'react';\nimport Web3 from 'web3';\n\nimport user from './abis/user.json';\n\nimport { AuthProvider } from './contexts/AuthContext';\n\nimport NavBar from './Components/NavBar';\nimport PrivateRoute from './Components/PrivateRoute';\n\n\nimport Dashboard from './Pages/Dashboard';\n\n\n\n// IPFS for ID proofs of Driver\nconst ipfsClient = require('ipfs-http-client');\nconst ipfs = ipfsClient({ host: 'ipfs.infura.io', port: 5001, protocol: 'https' }); // leaving out the arguments will default to these values\n\nconst authorizedAccounts = ['0x50Fe6C433c41595396044A9bcdF9500963D4e236']\nconst authorizedAccounts2 = ['0x2fb5eBC35A6d6e7c26bEC01122b34d84D7727aD9']\n\nclass App extends Component{\n  async componentWillMount() {\n    await this.loadWeb3()\n    await this.loadBlockchainData()\n  }\n\n  async loadWeb3() {\n    if (window.ethereum) {\n      window.web3 = new Web3(window.ethereum)\n      await window.ethereum.enable()\n    }\n    else if (window.web3) {\n      window.web3 = new Web3(window.web3.currentProvider)\n    }\n    else {\n      window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\n    }\n  }\n\n  async loadBlockchainData() {\n    const web3 = window.web3\n    // Load account\n    const accounts = await web3.eth.getAccounts()\n    \n\n    this.setState({ account: accounts[0] })\n    const unitbal = await web3.eth.getBalance(accounts[0])\n    const  balanceacc = await web3.utils.fromWei(unitbal,'ether')\n\n    this.setState({balance: balanceacc})\n\n    const networkId = await web3.eth.net.getId()\n    const networkData = user.networks[networkId]\n    console.log(networkData);\n\n    if (networkData) {\n      const User = new web3.eth.Contract(user.abi, networkData.address)\n      this.setState({ User })\n\n      const reqCounts = await User.methods.reqCount().call()\n      this.setState({ reqCounts })\n      \n      const imgCounts = await User.methods.imgCount().call()\n      this.setState({ imgCounts })\n\n      const rideCounts = await User.methods.rideCount().call()\n      this.setState({ rideCounts })\n      \n      //Load requests\n      for (var i = 1; i <= reqCounts; i++) {\n        const users_var = await User.methods.users(i).call()\n        this.setState({\n          users: [...this.state.users,users_var]\n        })\n      }\n\n      //Load images\n\n      for (var j=1; j<=imgCounts; j++){\n        const img_var = await User.methods.driver(j).call()\n        this.setState({\n          driver: [...this.state.driver,img_var]\n        })\n      }\n     /** */\n\n     for (var k=1; k<=rideCounts; k++){\n      const ride_var = await User.methods.ride(k).call()\n      this.setState({\n        ride: [...this.state.ride,ride_var]\n      })\n    }\n\n    } else {\n      window.alert('User contract not deployed to detected network.')\n    }\n\n\n  }\n\n  uploadIdProof= event => {\n    event.preventDefault()\n    const file = event.target.files[0]\n    const reader = new window.FileReader()\n    reader.readAsArrayBuffer(file)\n\n    reader.onloadend = () => {\n      this.setState({ buffer: Buffer(reader.result) })\n      console.log('buffer', this.state.buffer)\n    }\n  }\n\n  rideRequest = (source,destination,date,time) => {\n    this.setState({loading:true })\n      this.state.User.methods.rideReq(source,destination,date,time).send({from: this.state.account}).on('transactionHash', (hash) => {\n        this.setState({ loading: false })\n      })\n  }\n\n  uploadRide = (source,destination,date,time,rider,amount) => {\n    this.setState({loading:true })\n      this.state.User.methods.uploadRide(source,destination,date,time,rider,amount).send({from: this.state.account}).on('transactionHash', (hash) => {\n        this.setState({ loading: false })\n      })\n  }\n\n  uploadIdImage = (drivername,hash,verified) =>\n  {\n    this.state.User.methods.uploadImg(hash,drivername,verified).send({from: this.state.account}).on('transactionHash',(hash) => {\n      this.setState({loading:false})\n    })\n\n  }\n  uploadImage = drivername => {\n    // console.log(\"submitting file to ipfs...\")\n\n    ipfs.add(this.state.buffer, (error, result) => {\n      // console.log('Ipfs result', result)\n      if (error) {\n        console.error(error)\n        return\n      }\n\n    this.setState({loading:true})\n      this.state.User.methods.uploadImg(result[0].hash,drivername,false).send({from: this.state.account}).on('transactionHash',(hash) => {\n        this.setState({loading:false})\n      })\n    })\n  }\n  verifyDriver = (id,hashs,name,author) => {\n\n    this.state.User.methods.verifyDriver(id,hashs,name,author).send({from: this.state.account}).on('transactionHash',(hash) => {\n      this.setState({loading:false})\n    })\n    }\n\n    tipImageOwner = (id, tipAmount) =>{\n      this.setState({ loading: true })\n      this.setState({ loading: false })\n      this.state.cryptridez.methods.tipImageOwner(id).send({ from: this.state.account, value: tipAmount }).on('transactionHash', (hash) => {\n      })\n    }\n  \n    rideAmount = (id,amount) =>{\n      this.state.User.methods.ridePayment(id).send({ from: this.state.account, value: amount }).on('transactionHash', (hash) => {\n      })\n\n    \n    }\n  \n    constructor(props) {\n      super(props)\n      this.state = {\n        balance:'',\n        account: '',\n        User: null,\n        users:[],\n        driver:[],\n        ride:[],\n        loading: true,\n        navToggle:false,\n        \n      }\n    }\n    \n   render(){\n    //  let body;\n      \n     return ( \n          <div className=\"App\">\n            \n            <div className=\"main-content\">\n                <div className=\"content\">\n                <Router>\n                <div className={`sidebar ${this.state.navToggle ? 'nav-toggle': ''}`}>\n                <NavBar />\n            </div>\n            <div className=\"nav-btn\" onClick={this.setState({navToggle: true})}>\n              <div className=\"lines-1\"></div>\n              <div className=\"lines-2\"></div>\n              <div className=\"lines-3\"></div>\n            </div>\n                    <AuthProvider>\n                      <Switch>\n                        {/* <Route path=\"/\" component={HomePage}/> */}\n                        <PrivateRoute exact path=\"/\" component={Dashboard} />\n                        {/* <Route path=\"/signup\" component={SignUpPage} />\n                        <Route path=\"/login\" component={LoginPage} /> */}\n                      </Switch>\n                    </AuthProvider>\n              </Router>\n                </div>\n            </div>\n          </div>\n        );\n      }\n      \n     \n   }\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}